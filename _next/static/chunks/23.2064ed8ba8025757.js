"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[23,479],{7479:function(e,n,t){t.r(n),t.d(n,{default:function(){return j}});var a=t(5893),r=t(5988),c=t(7294),o=t(5819),i=t(7357),l=t(8456),s=t(3321),u=t(3946),d=t(4054),f=t(3841),v=t(4917),h=t(9074),m=t(5195),b=t(4229),g=t(7658),x=t(3851);var k=function(e){switch(function(e){var n=new Date;console.trace("["+n.toLocaleTimeString()+"] "+e)}(e),e.name){case"NotFoundError":alert("Unable to open your call because no camera and/or microphonewere found.");break;case"SecurityError":case"PermissionDeniedError":break;default:alert("Error opening your camera and/or microphone: "+e.message)}};function j(e){var n=e.defaultMute,t=void 0===n||n,j=e.hFlip,p=void 0!==j&&j,C=(0,c.useContext)(x.WebRTCContext),Z=(C.hangUpCall,C.joinConv),S=C.stopConv,I=C.peerConnection,E=(0,c.useContext)(g.F),y=E.localStream,w=E.setLocalStream,T=(0,c.useRef)(null),Y=(0,c.useState)(!1),D=Y[0],W=Y[1],_=(0,c.useState)(!1),F=_[0],L=_[1],N=(0,c.useState)([]),O=(N[0],N[1]),U=(0,c.useState)(""),z=U[0],A=U[1],M=(0,c.useState)(""),R=M[0],V=M[1],G=(0,c.useState)([]),P=G[0],q=G[1],B=(0,c.useState)([]),H=B[0],J=B[1],K=P.map((function(e){return(0,a.jsx)(o.Z,{value:e.deviceId,children:e.label},e.deviceId)})),Q=H.map((function(e){return(0,a.jsx)(o.Z,{value:e.deviceId,children:e.label},e.deviceId)}));(0,c.useEffect)((function(){if(y&&H.length>0){var e=y.getVideoTracks(),n=e?e[0]:void 0,t=H.find((function(e){return e.label===n.label}));V(t.deviceId)}}),[H,y]),(0,c.useEffect)((function(){if(y&&P.length>0){var e=y.getAudioTracks(),n=e?e[0]:void 0,t=P.find((function(e){return e.label===n.label}));A(t.deviceId)}}),[P,y]);var X=(0,c.useCallback)((function(e){O(e);var n=e.filter((function(e){return"audioinput"===e.kind})),t=e.filter((function(e){return"videoinput"===e.kind}));q(n),J(t)}),[]),$=(0,c.useCallback)((function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,a=function(n){n.getSenders().map((function(n){if(console.log(n.track),n.track){var t=e.getTracks().find((function(e){return e.kind===n.track.kind}));n.replaceTrack(t)}}))};L(!0),w(e);var r=T.current;return r.srcObject=e,r.volume=n?0:1,r.onloadedmetadata=function(){return r.play()},I&&a(I),Z(),navigator.mediaDevices.enumerateDevices()}),[T,t,w,I,Z]),ee=(0,c.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:z;y&&y.getTracks().forEach((function(e){e.stop()}));var t={audio:{deviceId:n?{exact:n}:void 0,echoCancellation:!0},video:{deviceId:e?{exact:e}:void 0}};navigator.mediaDevices.getUserMedia(t).then($).then(X).catch(k)}),[y,z,R,$,X]),ne=(0,c.useCallback)((function(e){V(e.target.value),ee(e.target.value)}),[ee]),te=(0,c.useCallback)((function(e){A(e.target.value),ee(void 0,e.target.value)}),[ee]),ae=(0,c.useCallback)((function(){ee()}),[ee]),re=(0,c.useCallback)((function(){L(!1),y&&y.getTracks().forEach((function(e){e.stop()})),T.current.srcObject=null,w(null),S()}),[y,w,S]);I&&["failed","closed"].includes(I.connectionState);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i.Z,{sx:{display:"flex",height:{xs:300,md:500},justifyContent:"center",alignItems:"center",backgroundColor:"black"},children:F?(0,a.jsx)("video",{ref:T,className:"jsx-21692c2f1b6e7001 "+((p?"video-hflip":"")||"")}):(0,a.jsx)(l.Z,{})}),(0,a.jsxs)(i.Z,{sx:{mt:1},children:[F?(0,a.jsx)(s.Z,{variant:"outlined",color:"error",onClick:re,startIcon:(0,a.jsx)(m.Z,{}),children:"Stop Live"}):(0,a.jsx)(s.Z,{variant:"contained",color:"error",onClick:ae,startIcon:(0,a.jsx)(h.Z,{}),children:"GO LIVE"}),F&&(0,a.jsx)(u.Z,{"aria-label":"settings",onClick:function(){W(!D&&F)},children:(0,a.jsx)(b.Z,{color:D?"primary":"inherit"})})]}),D&&""!=R&&(0,a.jsx)(i.Z,{sx:{minWidth:120,my:2},children:(0,a.jsxs)(d.Z,{fullWidth:!0,children:[(0,a.jsx)(f.Z,{id:"select-camera-source-label",children:"Camera source"}),(0,a.jsx)(v.Z,{labelId:"select-camera-source-label",id:"select-camera-source",value:R,label:"Select Camera",onChange:ne,children:Q})]})}),D&&""!=z&&(0,a.jsx)(i.Z,{sx:{minWidth:120,my:2},children:(0,a.jsxs)(d.Z,{fullWidth:!0,children:[(0,a.jsx)(f.Z,{id:"select-audio-source-label",children:"Audio source"}),(0,a.jsx)(v.Z,{labelId:"select-audio-source-label",id:"select-audio-source",value:z,label:"Select audio",onChange:te,children:K})]})}),(0,a.jsx)(r.default,{id:"21692c2f1b6e7001",children:'video.jsx-21692c2f1b6e7001{max-width:100%;\nmax-height:100%}\n.video-hflip.jsx-21692c2f1b6e7001{-webkit-transform:rotateY(180deg);\n-moz-transform:rotateY(180deg);\n-ms-transform:rotateY(180deg);\ntransform:rotateY(180deg);\n-webkit-transform:rotateY(180deg);\n-moz-transform:rotateY(180deg)}\n.brokenvideo.jsx-21692c2f1b6e7001{background-image:url("/broken_stream.gif");\nbackground-repeat:no-repeat;\nbackground-color:#cccccc;\nmargin-bottom:15px}'})]})}}}]);